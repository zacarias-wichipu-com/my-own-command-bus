#!/usr/bin/env php
<?php

require_once dirname(__DIR__) . '/vendor/autoload.php';

use App\Application\DisplayAwakeMessageCommand;
use App\Application\DisplayAwakeMessageCommandHandler;
use App\Application\DisplayEmojiTimeCommandHandler;
use App\Application\DisplaySleepMessageCommand;
use App\Application\DisplaySleepMessageCommandHandler;
use App\Application\DisplayTimeCommand;
use App\Application\PlayAlarmCommand;
use App\Application\PlayAlarmCommandHandler;
use App\Application\PlayBeepCommand;
use App\Application\PlayBeepCommandHandler;
use App\Clock;
use App\CommandBus;
use App\CommandHandlerDriver;
use App\EnglishDisplayMessage;

$commandHandlerDriver = new CommandHandlerDriver();
$commandHandlerDriver->registerCommands(
    commandFqn: DisplayTimeCommand::class,
    commandHandler: new DisplayEmojiTimeCommandHandler()
);
$commandHandlerDriver->registerCommands(
    commandFqn: DisplayAwakeMessageCommand::class,
    commandHandler: new DisplayAwakeMessageCommandHandler(new EnglishDisplayMessage())
);
$commandHandlerDriver->registerCommands(
    commandFqn: DisplaySleepMessageCommand::class,
    commandHandler: new DisplaySleepMessageCommandHandler(new EnglishDisplayMessage())
);
$commandHandlerDriver->registerCommands(
    commandFqn: PlayBeepCommand::class,
    commandHandler: new PlayBeepCommandHandler()
);
$commandHandlerDriver->registerCommands(
    commandFqn: PlayAlarmCommand::class,
    commandHandler: new PlayAlarmCommandHandler()
);
$commandBus = new CommandBus($commandHandlerDriver);
$clock = new Clock(
    commandBus: $commandBus,
    awakeAt: 7,
    sleepAt: 22
);
($clock)();
